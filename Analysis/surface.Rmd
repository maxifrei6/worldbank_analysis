---
title: "Worldbank Agriculture Analysis"
author: "Robin Billinger"
date: "`r Sys.Date()`"
output:
  html_document:
    self-contained: true
    clean: true
---

## Introduction
This analysis explores relationships between indicators across countries such as percentage of agricultural land, CO2 emissions per capita, and size of surface area using World Bank data. It is divided into two main parts, with this script focusing on the second question. For further observation of the first question, refer to the file 'Analysis/agriculture.Rmd'.
<br><br>
1. Is there a relationship between the percentage of agricultural land and CO2 emissions per capita across countries?
<br><br>
2. Does the **size of the surface area** of the country play a role?
<br>

```{r setup, echo = FALSE, message = FALSE}
# Load libraries
library(knitr)
library(here)
library(dplyr)
library(ggplot2)
library(tidyr)
library(RColorBrewer)
library(scales)
library(patchwork)
library(grid)
library(ggradar) # not available for some newer R versions

# Globally center all plots while displaying knitted version in HTML
knitr::opts_chunk$set(fig.align = "center")

# Load the processed 'data_agriculture' data set using 'here'
data_surface <- readRDS(here("Data", "Processed", "data_agriculture.RDS"))

# Save the ascending order of average surface area
country_order_by_surface <- data_surface %>%
  group_by(`Country Name`) %>%
  summarise(avg_AG.SRF.TOTL.K2 = mean(AG.SRF.TOTL.K2)) %>%
  ungroup() %>%
  arrange(avg_AG.SRF.TOTL.K2) %>%
  pull(`Country Name`)
```

### 2. Influence of surface area on previous relationship
One further aspect that might change the non-relationship recorded in the 'agriculture.Rmd' file is the introduction of another variable to take into account, namely the countries' surface areas.
<br><br>
Starting with the initial comparison between the variables within the ranges of the data observed, we get the following first overview.

```{r radar_agrLand_co2_surface, echo=FALSE, fig.height=6, fig.width=10, message=FALSE, warning=FALSE}
# Get an overview over surface data
summary(data_surface$AG.SRF.TOTL.K2)

# Radar chart for first overview of interaction of the three variables - bounded by country barriers
# set by the countries we are observing.
data_surface_radar <- data_surface %>%
  mutate(EN.GHG.CO2.MT.CE.AR5 = log10(EN.GHG.CO2.MT.CE.AR5 + 1),
         AG.SRF.TOTL.K2 = log10(AG.SRF.TOTL.K2 + 1)) %>%
  rename(log10_EN.GHG.CO2.MT.CE.AR5 = EN.GHG.CO2.MT.CE.AR5,
         log10_AG.SRF.TOTL.K2 = AG.SRF.TOTL.K2)

data_surface_radar <- data_surface_radar %>%
  group_by(`Country Name`) %>%
  summarize(across(matches("\\."), \(x) mean(x, na.rm = TRUE))) %>%
  mutate(across(matches("\\."), rescale)) %>%
  ungroup()

data_surface_radar <- data_surface_radar %>%
  pivot_longer(cols = matches("\\."), names_to = "Indicator", values_to = "Value") %>%
  pivot_wider(names_from = `Country Name`, values_from = Value)

ggradar(data_surface_radar,
        axis.label.size = 3,
        grid.label.size = 4,
        gridline.min.colour = "black",
        gridline.mid.colour = "black",
        gridline.max.colour = "black",
        group.line.width = 1,
        group.point.size = 2) +
  ggtitle("Indikatordaten im Zeitraum 2000 bis 2021",
          subtitle = "Mittlere Indikatordaten pro Land pro Indikator für 0 bis 100% der beobachteten Länder") +
  scale_color_manual(name = "Indikatoren [%]",
                     values = c("log10_AG.SRF.TOTL.K2" = brewer.pal(3, "Set2")[3],
                                "log10_EN.GHG.CO2.MT.CE.AR5" = brewer.pal(3, "Set2")[2],
                                "AG.LND.AGRI.ZS" = brewer.pal(3, "Set2")[1]),
                     labels = c("log10_AG.SRF.TOTL.K2" = "Landfläche (Log10)",
                                "log10_EN.GHG.CO2.MT.CE.AR5" = "CO2 Emissionen pro Kopf (Log10)",
                                "AG.LND.AGRI.ZS" = "Landwirtschaftliche Nutzfläche")) +
  theme_minimal() +
  theme(axis.text = element_blank(),
        legend.position = "right",
        legend.title = element_text(hjust = 0.5),
        legend.title.position = "top",
        panel.grid = element_blank())
```

```{r faceted_line_surface, echo=FALSE, fig.height=6, fig.width=10, message=FALSE, warning=FALSE}
# Lineplot to get an overview of the surface area development within each country over time in ascending order of surface area occurrence
ggplot(data_surface, aes(x = Year, y = AG.SRF.TOTL.K2)) +
  geom_line() +
  ggtitle("Landfläche nach Ländern") +
  scale_x_continuous(name = "Jahr", breaks = seq(2000, 2020, by = 10),
                     minor_breaks = seq(2000, 2021, by = 1)) +
  scale_y_continuous(name = expression(Landfläche ~ "[" ~ km^2 ~ "]")) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5)) + 
  facet_wrap(~ factor(`Country Name`, levels = country_order_by_surface), scales = "free_y")
```
<br>
As we can see, there are several countries with no changes in surface area throughout the interested time span at all. Therefore, before heading forward, we first want to zoom in a little closer on those with changes.

```{r changeless_countries, echo = FALSE, warning = FALSE, message = FALSE}
# Check in how many and which countries there is any change in surface area throughout the interested timespan
AG.SRF.TOTL.K2_countriesWithChange <- data_surface %>%
  group_by(`Country Name`) %>%
  summarize(noChange = all(AG.SRF.TOTL.K2 == AG.SRF.TOTL.K2[[1]])) %>%
  ungroup() %>%
  filter(!noChange) %>%
  pull(`Country Name`)
cat("Anzahl der Länder ohne Veränderungen: ", length(AG.SRF.TOTL.K2_countriesWithChange))

# Filter the data for only countries with changes in surface area
data_surface_change <- data_surface %>%
  filter(`Country Name` %in% AG.SRF.TOTL.K2_countriesWithChange) %>%
  select(`Country Name`, `Country Code`, Year, AG.SRF.TOTL.K2)
```
<br>

```{r changing_obs_absolute, echo=FALSE, fig.height=6, fig.width=10, message=FALSE, warning=FALSE}
# Investigate the absolute and relative changes for those countries from year to year
data_surface_change <- data_surface_change %>%
  # Ensure data is ordered by Country and Year
  arrange(`Country Name`, Year) %>%
  group_by(`Country Name`) %>%
  mutate(
    # Calculate changes
    Change = AG.SRF.TOTL.K2 - lag(AG.SRF.TOTL.K2),
    # Replace NAs for change from 1999 to 2000 with 0
    Change = ifelse(is.na(Change), 0, Change),
    # Absolute changes
    absChange = abs(AG.SRF.TOTL.K2 - lag(AG.SRF.TOTL.K2)),
    # Replace NAs for change from 1999 to 2000 with 0
    absChange = ifelse(is.na(absChange), 0, absChange),
    # Relative changes [%]
    relChange = ((AG.SRF.TOTL.K2 - lag(AG.SRF.TOTL.K2)) / lag(AG.SRF.TOTL.K2)) * 100,
    # Replace NAs for change from 1999 to 2000 with 0 %
    relChange = ifelse(is.na(relChange), 0, relChange)) %>%
  ungroup()

# Save the ascending order of average absolute change in surface area
country_order_by_surfaceAbs <- data_surface_change %>%
  group_by(`Country Name`) %>%
  summarise(avg_absChange = mean(absChange)) %>%
  arrange(avg_absChange) %>%
  ungroup() %>%
  pull(`Country Name`)

# Plot the changes in surface area for comparison between countries in order of ascending absolute changes
ggplot(data_surface_change, aes(x = Year)) +
  geom_bar(aes(y = Change, fill = Change < 0), stat = "identity") +
  geom_hline(yintercept = 0, linetype = "dashed") +
  ggtitle("Landfläche in Ländern mit Veränderungen zwischen 2000 und 2021") +
  scale_x_continuous(name = "Jahr", breaks = seq(2000, 2020, by = 5),
                     minor_breaks = seq(2000, 2021, by = 1)) +
  scale_y_continuous(name = expression(Absolute ~ Änderung ~ "in" ~ Landfläche ~ "[" ~ km^2 ~ "]")) +
  scale_fill_brewer(palette = "Set2", guide = "none") +  # Custom colors
  theme_bw() +
  theme(panel.spacing.y = unit(1, "lines"),
        plot.title = element_text(hjust = 0.5)) +
  facet_wrap(~ factor(`Country Name`,
                      levels = country_order_by_surfaceAbs), ncol = 2, scales = "free_y")
```
<br>
For the vast majority of the countries, the changes can be classified as under 1000 square kilometers over the whole time span. Similar insights can be derived when looking at the relative changes.

```{r changing_obs_relative, echo=FALSE, fig.height=6, fig.width=10, message=FALSE, warning=FALSE}
# Save the ascending order of average relative change in surface area
country_order_by_surfaceRel <- data_surface_change %>%
  group_by(`Country Name`) %>%
  summarise(avg_relChange = mean(relChange)) %>%
  arrange(avg_relChange) %>%
  ungroup() %>%
  pull(`Country Name`)

# Plot the relative changes in surface area for comparison between countries
plot_changingObs_left <- ggplot(data_surface_change, aes(x = Year, y = relChange)) +
  geom_line() +
  scale_x_continuous(name = "Jahr", breaks = seq(2000, 2020, by = 5),
                     minor_breaks = seq(2000, 2021, by = 1)) +
  scale_y_continuous(name = "Relative Änderung in Landfläche [%]") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5)) + 
  facet_wrap(~ factor(`Country Name`, levels = country_order_by_surfaceRel), ncol = 2)

# Plot the relative changes in surface area with free y-scale to make minimal changes recognizable
plot_changingObs_right <- ggplot(data_surface_change, aes(x = Year, y = relChange)) +
  geom_line() +
  scale_x_continuous(name = "Jahr", breaks = seq(2000, 2020, by = 5),
                     minor_breaks = seq(2000, 2021, by = 1)) +
  scale_y_continuous(name = "") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5)) + 
  facet_wrap(~ factor(`Country Name`,
                      levels = country_order_by_surfaceRel), ncol = 2, scales = "free_y")

# Concatenate the two plots side by side
(plot_changingObs_left | plot_changingObs_right) + 
  plot_annotation(title = "Landfläche in Ländern mit Veränderungen zwischen 2000 und 2021") &
  theme(plot.title = element_text(hjust = 0.5))
```
<br>
For each country, even those with changes throughout the time span, there are at most marginal changes of two percent in surface area. To finally confirm those claims, we take a look at the scatter decomposition.
```{r boxplot_surface, echo=FALSE, fig.height=6, fig.width=10, message=FALSE, warning=FALSE}
# Compute the between-country variance in surface area
data_surface_variance_between_surface <-
  var(data_surface %>%
        group_by(`Country Name`) %>%
        summarise(avg_surface = mean(AG.SRF.TOTL.K2)) %>%
        ungroup() %>%
        select(avg_surface))

# Create boxplots for within-country variances
ggplot(data_surface,
       aes(x = log10(AG.SRF.TOTL.K2 + 1),
           y = factor(`Country Name`, levels = country_order_by_surface))) +
  geom_boxplot() +
  ggtitle("Streuungszerlegung der Landfläche bezüglich Ländern") +
  scale_x_continuous(name = expression(Landfläche ~ "[" ~ km^2 ~ "]" ~ (Log10)),
                     breaks = log10(c(1000, 10000, 100000, 1000000, 10000000) + 1),
                     labels = c("1.000", "10.000", "100,000", "1.000.000", "10.000.000")) +
  scale_y_discrete(name = "Land") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

cat("Streuung zwischen den Ländern: " , data_surface_variance_between_surface)
```
<br> 
In conclusion, we recognize that the changes in surface area are negligible over time. Therefore, we drop our focus on the development over time considering this variable when moving on. More interesting might be shifting the perspective towards whether the absolute amount of surface area has any influence on the relationship between agricultural land and CO2 emissions for the observed countries.
<br>
<br> 
For this exploration, we want to distinguish our countries into the following groups:
```{r scatter_grouped, echo=FALSE, fig.height=6, fig.width=10, message=FALSE, warning=FALSE}
# Load the grouping dictionary using 'here'
data_grouped <- readRDS(here("Data", "Processed", "data_grouped.RDS"))

# Select only grouping regarding the agriculture and surface area topic
data_grouped <- data_grouped %>% select(`Country Name`, `Country Code`, cat_surface_area)

# Join the grouping to the existing 'data_surface' data set
data_surface <- left_join(data_surface, data_grouped, by = c("Country Name", "Country Code"))

# Plot the initial comparison via scatterplot, this time in grouped categories
ggplot(data_surface, aes(x = log10(EN.GHG.CO2.MT.CE.AR5 + 1), y = AG.LND.AGRI.ZS)) +
  geom_point(aes(fill = cat_surface_area), alpha = .5, size = 2.5, shape = 21) +
  geom_smooth(method = "lm", se = FALSE, color = "black") +
  ggtitle("Zusammenhang zwischen CO2 Emissionen pro Kopf und landwirtschaftlicher Nutzfläche") +
  scale_x_continuous(name = "CO2 Emissionen pro Kopf [Mt] (Log10)",
                     breaks = log10(c(0, 10, 100, 1000, 10000) + 1),
                     labels = c("0", "10", "100", "1.000", "10.000")) +
  scale_y_continuous(name = "Landwirtschaftliche Nutzfläche [%]") +
  scale_fill_viridis_d(name = "Landfläche", direction = -1, option = "plasma") +
  theme_bw() +
  theme(legend.title = element_text(hjust = 0.5),
        plot.title = element_text(hjust = 0.5))

# Plot the initial comparison via scatterplot, faceted by the grouped categories
# Plot the upper row of the faceted scatterplot
plot_surface1_upper_row <-
  ggplot(data_surface %>% filter(cat_surface_area %in% c("Sehr Klein", "Klein", "Mittel")),
         aes(x = log10(EN.GHG.CO2.MT.CE.AR5 + 1), y = AG.LND.AGRI.ZS)) +
  geom_point(alpha = .3, size = 2.5) +
  geom_smooth(method = "lm", se = FALSE, color = "black") +
  ggtitle("Zusammenhang zwischen CO2 Emissionen pro Kopf und landwirtschaftlicher Nutzfläche\nfür Ländergruppen bezüglich deren Landfläche") +
  scale_x_continuous(name = "CO2 Emissionen pro Kopf [Mt] (Log10)",
                     breaks = log10(c(0, 10, 100, 1000, 10000) + 1),
                     labels = c("0", "10", "100", "1.000", "10.000"),
                     limits = c(0, log10(max(data_surface$EN.GHG.CO2.MT.CE.AR5) + 1))) +
  scale_y_continuous(name = "Landwirtschaftliche Nutzfläche [%]",
                     limits = c(0, max(data_surface$AG.LND.AGRI.ZS))) +
  theme_bw() +
  theme(axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        plot.title = element_text(hjust = 0.5)) +
  facet_wrap(~ cat_surface_area, ncol = 3)

# Plot the bottom row of the faceted scatterplot
plot_surface1_bottom_row <-
  ggplot(data_surface %>% filter(cat_surface_area %in% c("Groß", "Sehr Groß")),
         aes(x = log10(EN.GHG.CO2.MT.CE.AR5 + 1), y = AG.LND.AGRI.ZS)) +
  geom_point(alpha = .3, size = 2.5) +
  geom_smooth(method = "lm", se = FALSE, color = "black") +
  scale_x_continuous(name = "CO2 Emissionen pro Kopf [Mt] (Log10)",
                     breaks = log10(c(0, 10, 100, 1000, 10000) + 1),
                     labels = c("0", "10", "100", "1.000", "10.000"),
                     limits = c(0, log10(max(data_surface$EN.GHG.CO2.MT.CE.AR5) + 1))) +
  scale_y_continuous(name = "Landwirtschaftliche Nutzfläche [%]",
                     limits = c(0, max(data_surface$AG.LND.AGRI.ZS))) +
  theme_bw() +
  theme(axis.title.y = element_blank()) +
  facet_wrap(~ cat_surface_area, ncol = 2)

# Assemble the plot
wrap_elements(full = grid::textGrob("Landwirtschaftliche Nutzfläche [%]",
                                    rot = 90, gp = grid::gpar(fontsize = 12))) +
  (plot_surface1_upper_row /
     (plot_spacer() +
        plot_surface1_bottom_row +
        plot_spacer() +
        plot_layout(widths = c(.44, 2, .5)))) +
  plot_layout(widths = c(1, 99))
```
<br>
We see there is no direct influence obvious through the grouping of the data. Let's dig deeper by looking at the time-specific distribution.
```{r faceted_scatter_grouped, echo=FALSE, fig.height=6, fig.width=10, message=FALSE, warning=FALSE}
# Logarithmic CO2 emissions by country, average agricultural land [%] for color - faceted by groups
# Plot the upper row of the faceted scatterplot
plot_surface2_upper_row <-
  ggplot(data_surface %>% filter(cat_surface_area %in% c("Sehr Klein", "Klein", "Mittel")),
         aes(x = Year, y = log10(EN.GHG.CO2.MT.CE.AR5 + 1))) +
  geom_point(aes(fill = AG.LND.AGRI.ZS), alpha = 0.75, size = 2.5, shape = 21, stroke = 0.5) +
  geom_smooth(method = "lm", se = FALSE, color = "black") +
  ggtitle("Zusammenhang zwischen CO2 Emissionen pro Kopf und landwirtschaftlicher Nutzfläche\nfür Ländergruppen bezüglich deren Landfläche") +
  scale_x_continuous(name = "Jahr", breaks = seq(2000, 2020, by = 5),
                     minor_breaks = seq(2000, 2021, by = 1)) +
  scale_y_continuous(name = "CO2 Emissionen pro Kopf\n[Mt] (Log10)",
                     breaks = log10(c(0, 10, 100, 1000, 10000) + 1),
                     labels = c("0", "10", "100", "1.000", "10.000"),
                     limits = c(0, log10(max(data_surface$EN.GHG.CO2.MT.CE.AR5) + 1))) +
  scale_fill_viridis_c(direction = -1, option = "plasma") +
  theme_bw() +
  theme(axis.text.x = element_text(hjust = 0.5),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        legend.position = "none",
        plot.title = element_text(hjust = 0.5)) +
  facet_wrap(~ cat_surface_area, ncol = 3)

# Plot the bottom row of the faceted scatterplot
plot_surface2_bottom_row <-
  ggplot(data_surface %>% filter(cat_surface_area %in% c("Groß", "Sehr Groß")),
         aes(x = Year, y = log10(EN.GHG.CO2.MT.CE.AR5 + 1))) +
  geom_point(aes(fill = AG.LND.AGRI.ZS), alpha = 0.75, size = 2.5, shape = 21, stroke = 0.5) +
  geom_smooth(method = "lm", se = FALSE, color = "black") +
  scale_x_continuous(name = "Jahr", breaks = seq(2000, 2020, by = 5),
                     minor_breaks = seq(2000, 2021, by = 1)) +
  scale_y_continuous(name = "CO2 Emissionen pro\nKopf [Mt] (Log10)",
                     breaks = log10(c(0, 10, 100, 1000, 10000) + 1),
                     labels = c("0", "10", "100", "1.000", "10.000"),
                     limits = c(0, log10(max(data_surface$EN.GHG.CO2.MT.CE.AR5) + 1))) +
  scale_fill_viridis_c(name = "Landwirtschaftliche Nutzfläche [%]",
                       direction = -1, option = "plasma") +
  theme_bw() +
  theme(axis.text.x = element_text(hjust = 0.5),
        axis.title.y = element_blank(),
        legend.position = "bottom",
        legend.title = element_text(vjust = 0.8),
        plot.title = element_text(hjust = 0.5)) +
  facet_wrap(~ cat_surface_area, ncol = 2)

# Assemble the plot
wrap_elements(full = textGrob("CO2 Emissionen pro Kopf [Mt] (Log10)",
                              rot = 90, gp = gpar(fontsize = 12))) +
  (plot_surface2_upper_row /
     (plot_spacer() +
        plot_surface2_bottom_row +
        plot_spacer() +
        plot_layout(widths = c(.33, 2, .5)))) +
  plot_layout(widths = c(1, 99))
```
<br>
The biggest anomalies regarding the CO2 emissions with the percentage of agricultural land in mind seem to be the moderate and very large surface area countries. Here on one hand, we can detect comparably high percentages in agricultural land for the moderate area countries, but those do not transfer themselves to any obvious differences in the CO2 emissions compared to the other groups. On the other hand, the very large countries stand out by having the supposedly expectable highest CO2 emissions among all groups. Marginal differences appear between the development over time, as the very large area countries are constant over the two decade timespan, while the other groups have slightly increasing trends.
<br>
If we finally pivot back to our normalized comparison we did earlier, we can do the same now with our grouped data according to the surface area categories.

```{r group-faceted scatterplot normalized, echo=FALSE, fig.height=6, fig.width=10, message=FALSE, warning=FALSE}
# (Min; Max)-normalize variable CO2 emissions to same scale as agricultural land [%]
data_surface_normd <- data_surface %>%
  group_by(`Country Name`) %>%
  mutate(
    co2_min = min(EN.GHG.CO2.MT.CE.AR5),
    co2_max = max(EN.GHG.CO2.MT.CE.AR5),
    co2_normd = ((EN.GHG.CO2.MT.CE.AR5 - co2_min) / (co2_max - co2_min))
  ) %>%
  ungroup()

# Pivot normalized 'data_surface' data set to longer format for better visualization of two variables
data_surface_normd_long <- data_surface_normd %>%
  pivot_longer(cols = c(co2_normd, AG.LND.AGRI.ZS),
               names_to = "variable", values_to = "value") %>%
  mutate(value = case_when(
    variable == "co2_normd" ~ value * 100,  # used for [%] comparison
    variable == "AG.LND.AGRI.ZS" ~ value))

# Plotting with normalized data over time for each group
# Plot the upper row of the faceted normalized scatterplot
plot_surface3_upper_row <-
  ggplot(data_surface_normd_long %>%
           filter(cat_surface_area %in% c("Sehr Klein", "Klein", "Mittel")),
         aes(x = Year, y = value, group = interaction(`Country Name`, variable))) +
  geom_point(aes(fill = variable), alpha = 0.3, size = 2.5, shape = 21, stroke = 0.5) +
  geom_smooth(aes(group = variable),
              method = "lm", se = FALSE, color = "black", size = 1.5) +
  geom_smooth(aes(group = variable, color = variable),
              method = "lm", se = FALSE, size = 1, show.legend = FALSE) +
  ggtitle("Zusammenhang zwischen CO2 Emissionen pro Kopf und landwirtschaftlicher Nutzfläche\nfür Ländergruppen bezüglich deren Landfläche") +
  scale_x_continuous(name = "Jahr",
                     breaks = seq(2000, 2020, by = 5),
                     minor_breaks = seq(2000, 2021, by = 1)) +
  scale_y_continuous(name = "Anteil [%]", limits = c(0, 100)) +
  scale_color_brewer(palette = "Set2") +
  scale_fill_brewer(palette = "Set2",  # Colorblind-friendly palette
                    labels = c("Landwirtschaftliche Nutzfläche [%]",
                               "(Min; Max)-normalisierte CO2 Emissionen pro Kopf [%]")) +
  theme_bw() +
  theme(axis.text.x = element_text(hjust = 0.5),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        legend.position = "none",
        plot.title = element_text(hjust = 0.5)) +
  facet_wrap(~ cat_surface_area, ncol = 3)

# Plot the bottom row of the faceted normalized scatterplot
plot_surface3_bottom_row <-
  ggplot(data_surface_normd_long %>% filter(cat_surface_area %in% c("Groß", "Sehr Groß")),
         aes(x = Year, y = value, group = interaction(`Country Name`, variable))) +
  geom_point(aes(fill = variable), alpha = 0.3, size = 2.5, shape = 21, stroke = 0.5) +
  geom_smooth(aes(group = variable),
              method = "lm", se = FALSE, color = "black", size = 1.5) +
  geom_smooth(aes(group = variable, color = variable),
              method = "lm", se = FALSE, size = 1, show.legend = FALSE) +
  scale_x_continuous(name = "Jahr", breaks = seq(2000, 2020, by = 5),
                     minor_breaks = seq(2000, 2021, by = 1)) +
  scale_y_continuous(name = "Anteil [%]", limits = c(0, 100)) +
  scale_color_brewer(name = "", palette = "Set2", labels = c("A", "B")) +
  scale_fill_brewer(name = "", palette = "Set2",  # Colorblind-friendly palette
                    labels = c("Landwirtschaftliche Nutzfläche [%]",
                               "(Min; Max)-normalisierte CO2 Emissionen pro Kopf [%]")) +
  theme_bw() +
  theme(axis.text.x = element_text(hjust = 0.5),
        axis.title.y = element_blank(),
        legend.position = "bottom",
        legend.text = element_text(size = 12),
        plot.title = element_text(hjust = 0.5)) +
  facet_wrap(~ cat_surface_area, ncol = 2)

# Assemble the plot
wrap_elements(full = textGrob("Anteil [%]", rot = 90, gp = gpar(fontsize = 12))) +
  (plot_surface3_upper_row /
     (plot_spacer() +
        plot_surface3_bottom_row +
        plot_spacer() +
        plot_layout(widths = c(.4, 2, .5)))) +
  plot_layout(widths = c(1, 99))
```

<br>
We cannot identify any obvious connection between the CO2 emissions per capita and the percentage of agricultural land even with the interested countries categorized by surface area.
