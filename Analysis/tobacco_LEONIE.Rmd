---
title: "Worldbank Tobacco Analysis"
author: "Leonie Mertes"
date: "`r Sys.Date()`"
output:
  html_document: default
---
## Introduction
This analysis explores the relationship of prevalence of current tobacco use (% of adults) prevalence to GDP per capita. Therefore we analyse the following leading question:
1. How does GDP per capita relate to the prevalence of current tobacco use (% of adults)?
<br>
<br>
```{r setup, message = FALSE, echo = FALSE, warning = FALSE}
# Load necessary libraries
library(dplyr)
library(ggplot2)

# Load the dataset
data_merged <- readRDS("C:/Users/Leonie/Documents/Studium/3. Semester/Statsoft/worldbank_analysis/Data/Processed/data_merged.RDS")
data_grouped <- readRDS("C:/Users/Leonie/Documents/Studium/3. Semester/Statsoft/worldbank_analysis/Data/Processed/data_grouped.RDS")
data_processed <- left_join(data_merged, data_grouped, by = c("Country Name", "Country Code"))
data_tob <- data_processed %>% 
  select(`Country Name`, `Country Code`, Year, NY.GDP.PCAP.PP.KD, SH.PRV.SMOK, tobacco_prev)
```
<br>
### 1. Tobacco Prevalence and GDP
<br>
Check how many NA's in tobacco variable each Year (excluding years existing only of NA's)
<br>
```{r, message = FALSE, echo = FALSE, warning = FALSE, fig.align = "left"}
data_tob %>%
  group_by(Year) %>%
  reframe(num_na = sum(is.na(SH.PRV.SMOK))) %>%
  filter(num_na < 25)
```
<br>
Knowing there are only 25 countries to investigate, we only have data of the Years 2000, 2005, 2010, 1015, 1018, 2019 and 2020 on percentage of tabacco usage in the adult population of all 24 countries (excluding Aruba).
<br>
To take a look at the grouping of our data by tobacco prevalence, we will display a plot of the most recent data in Year 2020.
<br>
```{r, echo=FALSE, warning = FALSE, message = FALSE, fig.align = "left"}
data_tob %>%
  filter(Year == 2020) %>%
  ggplot(aes(`Country Name`, SH.PRV.SMOK, colour = tobacco_prev)) +
  geom_point(size = 3, alpha = 0.7) +
  labs(
    y = "Anteil der tabakkonsumierenden Erwachsenen",
    x = "Land",
    title = "Gruppierung der Daten im Jahr 2020",
    colour = "verhältnismäßiger Tabakkonsum"
  ) +
  theme(axis.text.x = element_text(
    angle = 45,
    hjust = 1,
    size = 4
  ))
```
<br>

