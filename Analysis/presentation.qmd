---
title: "Worldbank Analysis"
subtitle: "subtitle"
author: "Robin Billinger, Leonie Mertes, Iman Saffari, Maximilian Frei"
institute: "institute"
date: "2025-01-21"
format: 
  revealjs:
    self-contained: true
editor: visual
execute:
  echo: false
  warning: false
  message: false
---

```{r setup, include=FALSE}
#source("env_setup.R")

```

## Agenda

::: incremental
1.  Überblick und Terminologie

2.  Datenanalyse

    2.1 Electricity and National Income\
    2.2 Education\
    2.3 HIV\
    2.4 Tobacco\
    2.5 Agriculture

3.  Zusammenfassung und Diskussion
:::

## Überblick

**Worldbank Datensatz**

::: incremental
-   **Erhebungsart**: Logitudinal

-   25 Länder über 22 Jahre (2000 - 2021) untersucht

    -- Weitere Details

-   18 verschiedene Indikatoren
:::

## Terminologie

::: incremental
-   **fachbegriff**: kurze Beschreibung

-   **weiterer fachbegriff**: kurze Beschreibung
:::

## 2.1 Electricity and National Income (1/2) {.smaller}

How does access to electricity correlate with adjusted net national income per capita across different countries?

## 2.1 Electricity and National Income (2/2) {.smaller}

Does this also depend on the country size or the inhabitants?

## 2.2 Education (1/2) {.smaller}

Do countries with **higher central government debt (% of GDP)** have a **lower % of labor force with basic education**?

```{r}
# Load necessary libraries
library(dplyr)
library(ggplot2)
library(tidyr)

# Load the dataset
data_merged <- readRDS("/Users/maximilian/Desktop/wb_local/Data/Processed/data_merged.RDS")
data_grouped <- readRDS("/Users/maximilian/Desktop/wb_local/Data/Processed/data_grouped.RDS")
data_education <- left_join(data_merged, data_grouped, by = c("Country Name", "Country Code"))

# Faceted scatter plot: Debt vs Education by Income Level
ggplot(data_education, aes(x = GC.DOD.TOTL.GD.ZS, y = SL.TLF.BASC.ZS, color = cat_income_level)) +
  geom_point(alpha = 0.7, size = 3) +
  geom_smooth(method = "lm", se = FALSE, color = "black") +
  facet_wrap(~ cat_income_level) +
  labs(
    title = "Central Government Debt vs Labor Force with Basic Education by Income Level",
    x = "Central Government Debt (% of GDP)",
    y = "Labor Force with Basic Education (%)",
    color = "Income Level"
  ) +
  theme_minimal() +
  theme(strip.text = element_text(face = "bold"))
```

## 2.2 Education (2/2) {.smaller}

Are countries with higher percentage of labor force with basic education able to maintain **lower** pupil-teacher ratios, and what impact might this have on education quality?

## 2.3 HIV (1/2) {.smaller}

How does the **HIV prevalence in the population aged 15-49** relate to the **total alcohol consumption per capita**?

```{r}
# Load necessary libraries
library(dplyr)
library(ggplot2)
library(tidyr)

# Load the dataset
data_merged <- readRDS("C:\\Users\\Leonie\\Documents\\Studium\\3. Semester\\StatSoft\\worldbank_analysis\\Data\\Processed\\data_merged.RDS")
data_grouped <- readRDS("C:\\Users\\Leonie\\Documents\\Studium\\3. Semester\\StatSoft\\worldbank_analysis\\Data\\Processed\\data_grouped.RDS")
data_processed <- left_join(data_merged, data_grouped, by = c("Country Name", "Country Code"))
data_hiv <- data_processed %>% 
  select(`Country Name`, `Country Code`, Year, SH.DYN.AIDS.ZS, SH.ALC.PCAP.LI, SL.TLF.BASC.ZS, cat_alc, cat_education)

data_hiv %>%
  group_by(Year, cat_alc) %>%
  summarise(
    SH.DYN.AIDS.ZS = mean(SH.DYN.AIDS.ZS, na.rm = TRUE),
    SH.ALC.PCAP.LI = mean(SH.ALC.PCAP.LI, na.rm = TRUE),
    .groups = "drop"
  ) %>%
  ggplot(aes(Year, SH.DYN.AIDS.ZS, colour = cat_alc)) +
  geom_point(size = 3, alpha = 0.7) +
  geom_line(aes(group = cat_alc)) +
  theme(axis.text.x = element_text(
    angle = 45,
    hjust = 1,
    size = 6
  )) +
  labs(
    title = "HIV Prävalenz über die Jahre",
    x = "Jahr",
    y = "HIV Prävalenz",
    colour = "relativer Alkoholkonsum"
  ) +
  scale_colour_brewer(palette = "Set2")
```

## 2.3 HIV (2/2) {.smaller}

Do countries with higher percentage of labor force with basic education have lower HIV prevalence rates in the 15-49 population?

```{r}
library(dplyr)
library(ggplot2)
library(tidyr)

# Load the dataset
data_merged <- readRDS("C:\\Users\\Leonie\\Documents\\Studium\\3. Semester\\StatSoft\\worldbank_analysis\\Data\\Processed\\data_merged.RDS")
data_grouped <- readRDS("C:\\Users\\Leonie\\Documents\\Studium\\3. Semester\\StatSoft\\worldbank_analysis\\Data\\Processed\\data_grouped.RDS")
data_processed <- left_join(data_merged, data_grouped, by = c("Country Name", "Country Code"))
data_hiv <- data_processed %>% 
  select(`Country Name`, `Country Code`, Year, SH.DYN.AIDS.ZS, SH.ALC.PCAP.LI, SL.TLF.BASC.ZS, cat_alc, cat_education)

data_hiv %>%
  filter(Year == 2020) %>%
  group_by(cat_education) %>%
  summarise(
    cat_education = cat_education,
    SH.DYN.AIDS.ZS = mean(SH.DYN.AIDS.ZS, na.rm = TRUE),
    SL.TLF.BASC.ZS = mean(SL.TLF.BASC.ZS, na.rm = TRUE),
    .groups = "drop"
  ) %>%
  ggplot(aes(SL.TLF.BASC.ZS, SH.DYN.AIDS.ZS, colour = cat_education)) +
  geom_point(size = 3, alpha = 0.7) +
  labs(
    x = "Anteil an Arbeitenden mit grundlegender Bildung",
    y = "HIV Prävalenz in %",
    title = "Bildungsstand vs. HIV Prävalenz im Jahr 2020",
    colour = "relativer Bildungsstand"
  ) +
  geom_smooth(aes(group = 1), method = "lm", se = FALSE) +
  scale_colour_brewer(palette = "Set2")
```

## 2.4 Tobacco Leonie (1/2) {.smaller}

How does GDP per capita relate to the prevalence of current tobacco use (% of adults)?

```{r}
# Load necessary libraries
library(dplyr)
library(ggplot2)

# Load the dataset
data_merged <- readRDS(
  "C:/Users/Leonie/Documents/Studium/3. Semester/Statsoft/worldbank_analysis/Data/Processed/data_merged.RDS"
)
data_grouped <- readRDS(
  "C:/Users/Leonie/Documents/Studium/3. Semester/Statsoft/worldbank_analysis/Data/Processed/data_grouped.RDS"
)
data_processed <- left_join(data_merged, data_grouped, by = c("Country Name", "Country Code"))
data_tob <- data_processed %>%
  select(`Country Name`,
         `Country Code`,
         Year,
         NY.GDP.PCAP.PP.KD,
         SH.PRV.SMOK,
         cat_tob_usage)

data_tob %>%
  group_by(Year, cat_tob_usage) %>%
  summarise(
    NY.GDP.PCAP.PP.KD = mean(NY.GDP.PCAP.PP.KD, na.rm = TRUE),
    SH.PRV.SMOK = mean(SH.PRV.SMOK, na.rm = TRUE),
    .groups = "drop"
  ) %>%
  ggplot(aes(Year, NY.GDP.PCAP.PP.KD, colour = cat_tob_usage)) +
  geom_point(size = 3, alpha = 0.7) +
  geom_line(aes(group = cat_tob_usage)) +
  theme(axis.text.x = element_text(
    angle = 45,
    hjust = 1,
    size = 6
  )) +
  labs(
    x = "Jahr",
    y = "BIP pro Kopf in $",
    title = "Tabakkonsum vs. BIP",
    colour = "relativer Tabakkonsum"
  ) +
  scale_colour_brewer(palette = "Set2")
```

## 2.4 Tobacco (2/2) {.smaller}

Further analysis of tobacco.

## 2.5 Agriculture (1/2) {.smaller}

Is there a relationship between the percentage of agricultural land and CO2 emissions per capita across countries?

## 2.5 Agriculture (2/2) {.smaller}

Does the size of the surface area of the country play a role?

## Zusammenfassung und Diskussion {.smaller}
